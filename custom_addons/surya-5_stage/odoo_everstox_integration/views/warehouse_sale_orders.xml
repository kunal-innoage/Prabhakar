<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="everstox_shop_sale_order_view_tree" model="ir.ui.view">
        <field name="name">Everstox Sale Orders</field>
        <field name="model">everstox.shop.order</field>
        <field name="arch" type="xml">
            <tree default_order = "create_date desc">
                <field name="order_number"></field>
                <field name="order_id"></field>
                <field name="state"></field>
                <field name="order_date"></field>
                <field name="financial_status"></field>
                <field name="everstox_shop_id"></field>
            </tree>
        </field>
    </record>

    <record id="everstox_order_view_form" model="ir.ui.view">
        <field name="name">Everstox Order Form View</field>
        <field name="model">everstox.shop.order</field>
        <field name="arch" type="xml">
            <form>
                <header>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                    </div>

                    <group>
                        <group>
                            <field name="order_number"></field>
                            <field name="order_id"></field>
                            <field name="state"></field>
                            <field name="order_date"></field>
                            <field name="creation_date"></field>
                            <field name="udpated_date"></field>
                            <field name="custom_email"></field>
                            <field name="financial_status"></field>
                            <field name="hours_late"></field>
                            <field name="order_priority"></field>
                            <field name="out_of_stock_hours"></field>
                            <field name="payment_methods"></field>
                            <field name="order_attachment"></field>
                        </group>
                        <group>
                            <field name="everstox_shop_id"></field>
                            <field name="order_shop_id"></field>
                            <field name="sale_order_id"></field>
                            <field name="requested_delivery_date"></field>
                            <field name="requested_warehouse_id"></field>
                            <field name="shop_instance_id"></field>
                            <field name="shop_instance_name"></field>
                            <field name="order_errors"></field>
                            <field name="order_returns"></field>
                            <field name="order_attachments"/>
                            <field name="order_custom_attributes"/>
                        </group>
                    </group>

                    <notebook>
                        <page name="sale_order_lines" string="Order Lines">
                            <field name="shop_order_line_ids">
                                <tree>
                                    <field name="order_line_id"></field>
                                    <field name="order_line_product_name"></field>
                                    <field name="order_line_quantity"></field>
                                    <field name="order_line_price"></field>
                                    <field name="order_line_tax"></field>
                                    <field name="order_line_state"></field>
                                    <field name="order_line_shipment_options_name"></field>
                                </tree>
                            </field>
                        </page>

                        <page name="fulfillments" string="Fulfillments">
                            <field name="shop_order_fulfillment_ids">
                                <tree delete="false" create="false">
                                    <field name="fulfillment_id"></field>
                                    <field name="fulfillment_product_name"></field>
                                    <field name="fulfillment_quantity"></field>
                                    <field name="fulfillment_state"></field>
                                    <field name="fulfillment_order_item_id"></field>
                                    <field name="fulfillment_warehouse_name"></field>
                                    <button name="cancel_fulfillment" string="Cancel" type="object" class="btn btn-primary rounded shadow"/>
                                    <!-- <field name="shipment_ids" widget="many2many_tags"></field>> -->
                                </tree>
                            </field>
                        </page>

                        <page name="returns" string="Returns">
                            <field name="shop_order_return_ids">
                                <tree>
                                    <field name="return_id"></field>
                                    <field name="order_number"></field>
                                    <field name="return_reference"></field>
                                    <field name="state"></field>
                                    <field name="return_date"></field>
                                    <field name="return_warehouse_id"></field>
                                    <field name="return_warehouse_name"></field>
                                </tree>
                            </field>
                        </page>

                        <page name="shipping_price" string="Shipping Price">
                            <group>
                                <group>
                                    <field name="shipping_price" ></field>
                                    <field name="shipping_price_gross" ></field>
                                    <field name="shipping_price_currency" ></field>
                                    <field name="shipping_price_discount" ></field>
                                    <field name="shipping_price_discount_gross" ></field>
                                    <field name="shipping_price_discount_net" ></field>
                                </group>
                                <group>
                                    <field name="shipping_price_net_after_discount" ></field>
                                    <field name="shipping_price_net_before_discount" ></field>
                                    <field name="shipping_price_tax" ></field>
                                    <field name="shipping_price_tax_amount" ></field>
                                    <field name="shipping_price_tax_rate" ></field>
                                </group>
                            </group>
                        </page>

                        <page name="billing_address" string="Billing Address">
                            <group>
                                <group>
                                    <field name="billing_first_name" ></field>
                                    <field name="billing_last_name" ></field>
                                    <field name="billing_contact_person" ></field>
                                    <field name="billing_title" ></field>
                                    <field name="billing_phone" ></field>
                                    <field name="billing_vat_number" ></field>
                                    <field name="billing_sub_department" ></field>
                                    <field name="billing_company" ></field>
                                    <field name="billing_province" ></field>
                                    <field name="billing_province_code" ></field>
                                </group>
                                <group>
                                    <field name="billing_address_1" ></field>
                                    <field name="billing_address_2" ></field>
                                    <field name="billing_address_type" ></field>
                                    <field name="billing_city" ></field>
                                    <field name="billing_country" ></field>
                                    <field name="billing_country_code" ></field>
                                    <field name="billing_zip" ></field>
                                    <field name="billing_latitude" ></field>
                                    <field name="billing_longitude" ></field>
                                </group>
                            </group>
                        </page>

                        <page name="shipping_address" string="Shipping Address">
                            <group>
                                <group>
                                    <field name="shipping_first_name" ></field>
                                    <field name="shipping_last_name" ></field>
                                    <field name="shipping_contact_person" ></field>
                                    <field name="shipping_title" ></field>
                                    <field name="shipping_phone" ></field>
                                    <field name="shipping_sub_department" ></field>
                                    <field name="shipping_department" ></field>
                                    <field name="shipping_company" ></field>
                                    <field name="shipping_province" ></field>
                                    <field name="shipping_province_code" ></field>
                                </group>
                                <group>
                                    <field name="shipping_address_1" ></field>
                                    <field name="shipping_address_2" ></field>
                                    <field name="shipping_address_type" ></field>
                                    <field name="shipping_city" ></field>
                                    <field name="shipping_country" ></field>
                                    <field name="shipping_country_code" ></field>
                                    <field name="shipping_zip" ></field>
                                    <field name="shipping_latitude" ></field>
                                    <field name="shipping_longitude" ></field>
                                </group>
                            </group>
                        </page>
                    </notebook>
                    
                </sheet>
            </form>
        </field>
    </record>

    <!-- Filters -->
    <record id="view_everstox_order_filters" model="ir.ui.view">
        <field name="name">everstox_order_filters</field>
        <field name="model">everstox.shop.order</field>
        <field name="mode">primary</field>
        <field name="arch" type="xml">
            <search string="Search Orders To Map">
                <group expand="0" string="Group By">
                    <filter string="Create Date" name="create_date" domain="[ ]" context="{'group_by': 'create_date:day'}" />
                    <filter string="Mapped Status" name="everstox_mapped_state" domain="[ ]" context="{'group_by': 'everstox_mapped_state'}" />
                    <filter string="State" name="order_state" domain="[ ]" context="{'group_by': 'state'}" />
                </group>
            </search>
        </field>    
    </record>
    

    <!-- Server Actions -->

    <record id="model_order_everstox_mapping" model="ir.actions.server">
        <field name="name">Create Order</field>
        <field name="model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="binding_model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="state">code</field>
        <field name="code">action = records.prepare_order_and_order_data()</field>
    </record>

    <record id="model_order_everstox_update" model="ir.actions.server">
        <field name="name">Update Order</field>
        <field name="model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="binding_model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="state">code</field>
        <field name="code">action = records.update_order()</field>
    </record>

    <record id="model_order_everstox_cancel" model="ir.actions.server">
        <field name="name">Cancel Order</field>
        <field name="model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="binding_model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="state">code</field>
        <field name="code">action = records.cancel_order()</field>
    </record>

    <record id="model_order_everstox_delete" model="ir.actions.server">
        <field name="name">Delete Order</field>
        <field name="model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="binding_model_id" ref="odoo_everstox_integration.model_everstox_shop_order"/>
        <field name="state">code</field>
        <field name="code">action = records.delete_order()</field>
    </record>

</odoo>
