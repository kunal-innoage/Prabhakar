<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="everstox_shop_view_kanban" model="ir.ui.view">
        <field name="name">Everstox Shop Kanban View</field>
        <field name="model">everstox.shop</field>
        <field name="arch" type="xml">
            <kanban>
                <field name="name"></field>
                <field name="warehouse_id"></field>
                <!-- <field name="shop_id"></field> -->
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click shadow rounded border-light mb-3">
                            <div class="row">
                                <div class="col-12 mb-3">
                                    <strong class="o_kanban_record_title"><span style="font-size: 20px;"><t t-esc="record.name.value"/></span></strong>
                                </div>
                            </div>
                            <div class="oe_kanban_details">
                                <!-- <div t-if="record.shop_id.value">
                                    <t t-esc="record.shop_id.value"/>
                                </div> -->
                                <div t-if="record.warehouse_id.value">
                                    <t t-esc="record.warehouse_id.value"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="everstox_shop_view_form" model="ir.ui.view">
        <field name="name">Everstox Shop Form View</field>
        <field name="model">everstox.shop</field>
        <field name="arch" type="xml">
            <form>
                <field name="is_warehouse_mapped" invisible="1"/>
                <field name="is_stock_synced" invisible="1"/>

                <header>
                    <button name="get_warehouse" string="Map Warehouse" type="object" class="btn btn-primary rounded shadow" attrs="{'invisible': [('is_warehouse_mapped', '=', True)]}"/>    
                    <button name="sync_stock_with_odoo" string="Sync Inventory" type="object" class="btn btn-primary rounded shadow" attrs="{'invisible': [('is_stock_synced', '=', False)]}"/>    
                    <button name="map_odoo_orders_to_everstox" string="Map New Orders" type="object" class="btn btn-primary rounded shadow mx-2" attrs="{'invisible': [('is_stock_synced', '=', False)]}"/>

                </header>

                <sheet>

                    <div class="oe_button_box" name="button_box">
                        <!-- <button name="action_view_everstox_Ifulfilments" type="object" class="oe_stat_button" icon="fa-cubes" >
                        <field name="total_product" widget="statinfo" string="Ifulfilments"/>
                        </button> -->
                        <button name="action_view_everstox_product" type="object" class="oe_stat_button" icon="fa-cubes" >
                        <field name="total_product" widget="statinfo" string="Product"/>
                        </button>
                        <button name="action_view_everstox_sale_orders" type="object" class="oe_stat_button" icon="fa-shopping-cart" >
                            <field name="shop_order_count" widget="statinfo" string="Order"/>
                        </button>
                        <button name="action_view_everstox_shipments" type="object" class="oe_stat_button" icon="fa-truck" >
                             <field name="shipment_count" widget="statinfo" string="Shipments"/>
                        </button>
                        <button name="action_view_everstox_returns" type="object" class="oe_stat_button" icon="fa-repeat" >
                             <field name="return_count" widget="statinfo" string="Returns"/>
                        </button>
                        <button name="action_view_everstox_warehouse_stock" type="object" class="oe_stat_button" icon="fa-bars" >
                              <field name="stock_count" widget="statinfo" string="Stocks"/>
                        </button>
                        <button name="action_view_everstox_tranfers" type="object" class="oe_stat_button" icon="fa-ship" >
                              <field name="transfer_count" widget="statinfo" string="Transfers"/>
                        </button>
                    </div>

                    <group>
                        <group>
                            <field name="name"></field>
                            <field name="shop_url"></field>
                        </group>
                        <group>
                            <field name="warehouse_id"></field>
                            <field name="everstox_warehouse_id" readonly="1"/>
                        </group>
                    </group>

                    <notebook>
                        <page name="config" string="Configuration" groups="base.group_system">
                            <group>
                                <group>
                                    <field name="shop_id"/>
                                    <field name="shop_instance_id"></field>
                                    <field name="shop_api_key"/>
                                </group>
                                <group name="carriers" string="Carriers">
                                    <button name="get_everstox_carriers" string="Get Carriers" type="object" class="btn btn-primary rounded shadow"/>
                                    <button name="action_view_shipment_options" type="object" class="oe_stat_button" icon="fa-truck" >
                                        <span>Carriers</span>
                                    </button>
                                </group>
                            </group>
                        </page>

                        <page string="Product Management" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}">
                            <field name="activate_product_filters" invisible="1"/>
                            <group>
                                <group  attrs="{'invisible': [('activate_product_filters', '=', False)]}"> 
                                    <button name="get_product" string="Get Product" type="object" class="btn btn-primary rounded shadow"/>
                                    <br/>
                                    <button name="map_odoo_products_to_everstox" string="Map New Products" type="object" class="btn btn-primary rounded shadow my-2"/>                                
                                </group>
                                <group attrs="{'invisible': [('activate_product_filters', '=', True)]}">  
                                    <button name="get_warehouse_products" string="Get All Products" type="object" class="btn btn-primary rounded shadow" />
                                    <br/>
                                    <button name="map_odoo_products_to_everstox" string="Map New Products" type="object" class="btn btn-primary rounded shadow my-2"/>                                
                                </group>
                                <group>
                                    <button name="action_view_everstox_product" type="object" class="oe_stat_button btn btn-info rounded shadow" icon="fa-cubes" >
                                        <span>Products</span>
                                    </button>
                                    <button name="action_view_warehouses_product_unit" type="object" class="oe_stat_button btn btn-info rounded shadow" icon="fa-cubes" >
                                        <span>Product Units</span>
                                    </button>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <field name="activate_product_filters"/>
                                </group>
                            </group>
                            <group string="Add Filters" attrs="{'invisible': [('activate_product_filters', '=', False)]}">
                                <group>
                                    <field name="product_item_id"/>
                                </group>
                            </group>
                        </page>

                        <page string="Order Management" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}">
                            <field name="activate_order_filter" invisible="1"/>
                            <group>
                                <group  attrs="{'invisible': [('activate_order_filter', '=', False)]}"> 
                                    <button name="get_orders" string="Get Order" type="object" class="btn btn-primary rounded shadow"/>
                                    <br/>
                                    <button name="map_odoo_orders_to_everstox" string="Map New Orders" type="object" class="btn btn-primary rounded shadow my-2" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}"/>
                                </group>
                                <group attrs="{'invisible': [('activate_order_filter', '=', True)]}">  
                                    <button name="get_orders" string="Get All Orders" type="object" class="btn btn-primary rounded shadow" />
                                    <br/>
                                    <button name="map_odoo_orders_to_everstox" string="Map New Orders" type="object" class="btn btn-primary rounded shadow my-2" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}"/>
                                </group>
                                <group>
                                    <button name="action_view_everstox_sale_orders" type="object" class="oe_stat_button btn btn-info rounded shadow" icon="fa-shopping-cart" >
                                        <span>Orders</span>
                                    </button>
                                    <button name="action_view_everstox_fulfillments" type="object" class="oe_stat_button btn btn-info rounded shadow">
                                        <span>Fulfillments</span>
                                    </button>
                                    <button name="action_view_everstox_shipments" type="object" class="oe_stat_button btn btn-info rounded shadow my-2" icon="fa-truck" >
                                        <span>Shipments</span>
                                    </button>
                                    <button name="action_view_everstox_returns" type="object" class="oe_stat_button btn btn-info rounded shadow my-2">
                                        <span>Returns</span>
                                    </button>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <field name="activate_order_filter"/>
                                </group>
                            </group>
                            <group string="Add Filters" attrs="{'invisible': [('activate_order_filter', '=', False)]}">
                                <group>
                                    <field name="order_number"/>
                                    <field name="order_state"></field>
                                </group>
                                <group>
                                    <field name="order_status"></field>
                                </group>
                            </group>
                        </page>

                        <page string="Stock Management" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}">
                            <field name="activate_stock_filter" invisible="1"/>
                            <group>
                                <group  attrs="{'invisible': [('activate_stock_filter', '=', False)]}"> 
                                    <button name="sync_warehouse_stock" string="Get Stocks" type="object" class="btn btn-primary rounded shadow"/>
                                    <br/>
                                    <button name="get_warehouse_stock_updates" string="Get Stock Updates" type="object" class="btn btn-primary rounded shadow my-2" attr="{'invisile': [('is_warehouse_mapped', '=', True)]}"/>
                                </group>
                                <group attrs="{'invisible': [('activate_stock_filter', '=', True)]}">  
                                    <button name="sync_warehouse_stock" string="Get All Stocks" type="object" class="btn btn-primary rounded shadow" />
                                    <br/>
                                    <button name="get_warehouse_stock_updates" string="Get Stock Updates" type="object" class="btn btn-primary rounded shadow my-2" attr="{'invisile': [('is_warehouse_mapped', '=', True)]}"/>
                                </group>
                                <group>
                                    <button name="action_view_everstox_warehouse_stock" string="Stocks" type="object" class="btn btn-info rounded shadow" />
                                    <button name="action_view_everstox_warehouse_stock_updates" string="Stocks Updates" type="object" class="btn btn-info rounded shadow" />
                                    <button name="action_view_everstox_warehouse_stock_items" string="Stocks Items" type="object" class="btn btn-info rounded shadow my-2" />
                                    <button name="action_view_everstox_warehouse_stock_quantities" string="Stocks Quantities" type="object" class="btn btn-info rounded shadow my-2" />
                                </group>
                            </group>
                            <group>
                                <group>
                                    <field name="activate_stock_filter"/>
                                </group>
                                <group>
                                    <field name="last_stock_update_time"></field>
                                </group>
                            </group>
                            <group string="Add Filters" attrs="{'invisible': [('activate_stock_filter', '=', False)]}">
                                <group>
                                    <field name="product_sku"/>
                                    <field name="stock_status"></field>
                                </group>
                                <group>
                                    <field name="stock_runway_lte"/>
                                    <field name="stock_runway_lt"/>
                                    <field name="stock_runway_gte"/>
                                </group>
                            </group>
                        </page>

                        <page string="Transfer Management" attrs="{'invisible': [('is_warehouse_mapped', '=', False)]}">
                            <field name="activate_transfer_filter" invisible="1"/>
                            <group>
                                <group  attrs="{'invisible': [('activate_transfer_filter', '=', False)]}"> 
                                    <button name="get_all_transfers" string="Get Transfers" type="object" class="btn btn-primary rounded shadow"/>
                                </group>
                                <group attrs="{'invisible': [('activate_transfer_filter', '=', True)]}">
                                    <button name="get_all_transfers" string="Get All Transfers" type="object" class="btn btn-primary rounded shadow" />
                                </group>
                                <group>
                                    <button name="action_view_everstox_tranfers" string="Transfers" type="object" class="btn btn-info rounded shadow" />
                                    <button name="action_view_everstox_tranfer_items" string="Transfer Items" type="object" class="btn btn-info rounded shadow" />
                                    <button name="action_view_everstox_tranfer_shipment" string="Transfer Shipment" type="object" class="btn btn-info rounded shadow my-2" />
                                    <button name="action_view_everstox_tranfer_shipment_item" string="Transfer Shipment Item" type="object" class="btn btn-info rounded shadow my-2" />
                                    <!-- <button name="action_view_everstox_tranfer_shipment_batches" string="Transfer Shipment Batches" type="object" class="btn btn-info rounded shadow my-2" /> -->
                                </group>
                            </group>
                            <group>
                                <group>
                                    <field name="activate_transfer_filter"/>
                                </group>
                            </group>
                            <group string="Add Filters" attrs="{'invisible': [('activate_transfer_filter', '=', False)]}">
                                <group>
                                    <field name="transfer_number"></field>
                                    <field name="transfer_state"></field>
                                </group>
                                <group>
                                    <field name="transfer_stategroup"></field>
                                </group>
                            </group>
                        </page>
                    </notebook>

                </sheet>
            </form>
        </field>
    </record>


    <!-- CRONS  -->
    <record id="get_everstox_stock_updates_cron" model="ir.cron">
        <field name="name">Get Stock Updates</field>
        <field name="model_id" ref="model_everstox_shop"/>
        <field name="state">code</field>
        <field name="code">model.get_everstox_stock_updates_cron()</field>
        <field name='interval_number'>1</field>
        <field name='interval_type'>hours</field>
        <field name="numbercall">-1</field>
        <field name="doall" eval="False"/>
    </record>

    <record id="get_everstox_order_update_cron" model="ir.cron">
        <field name="name">Get Order Update</field>
        <field name="model_id" ref="model_everstox_shop"/>
        <field name="state">code</field>
        <field name="code">model.get_everstox_order_updates_cron()</field>
        <field name='interval_number'>1</field>
        <field name='interval_type'>hours</field>
        <field name="numbercall">-1</field>
        <field name="doall" eval="False"/>
    </record>
    
</odoo>
